# Abigen å·¥ä½œåŸç†å¯è§†åŒ–è§£é‡Š

## ğŸ¯ æ ¸å¿ƒé—®é¢˜ï¼šä¸ºä»€ä¹ˆ Go ä»£ç å¯ä»¥ç›´æ¥è°ƒç”¨æ™ºèƒ½åˆçº¦ï¼Ÿ

### ç®€å•å›ç­”ï¼š
**Abigen å°±æ˜¯æ™ºèƒ½åˆçº¦å’Œ Go åº”ç”¨ä¹‹é—´çš„"ç¿»è¯‘å®˜"ï¼**

## ğŸ“Š å·¥ä½œæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Go åº”ç”¨ä»£ç    â”‚    â”‚    Abigen    â”‚    â”‚   æ™ºèƒ½åˆçº¦      â”‚
â”‚                 â”‚    â”‚   (ç¿»è¯‘å®˜)   â”‚    â”‚                 â”‚
â”‚ contract.Increment() â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ function increment() â”‚
â”‚                 â”‚    â”‚              â”‚    â”‚                 â”‚
â”‚ count, err :=   â”‚    â”‚              â”‚    â”‚                 â”‚
â”‚ contract.GetCount()  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ function getCount()  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” è¯¦ç»†å·¥ä½œè¿‡ç¨‹

### 1. è¾“å…¥é˜¶æ®µ
```
Solidity åˆçº¦ â†’ ç¼–è¯‘ â†’ ABI + å­—èŠ‚ç  â†’ Abigen
```

**è¾“å…¥æ–‡ä»¶ï¼š**
- `Counter.abi` - åˆçº¦æ¥å£è¯´æ˜
- `Counter.bin` - åˆçº¦å­—èŠ‚ç 

### 2. å¤„ç†é˜¶æ®µ
```
Abigen è§£æ ABI â†’ ç”Ÿæˆ Go ç»‘å®š â†’ å¤„ç†ç±»å‹è½¬æ¢ â†’ è¾“å‡º Go ä»£ç 
```

**å¤„ç†è¿‡ç¨‹ï¼š**
1. **è§£æ ABI**ï¼šè¯»å– JSON æ ¼å¼çš„åˆçº¦æ¥å£
2. **ç”Ÿæˆå‡½æ•°**ï¼šä¸ºæ¯ä¸ªåˆçº¦å‡½æ•°ç”Ÿæˆå¯¹åº”çš„ Go æ–¹æ³•
3. **ç±»å‹è½¬æ¢**ï¼šå°† Solidity ç±»å‹è½¬æ¢ä¸º Go ç±»å‹
4. **é”™è¯¯å¤„ç†**ï¼šæ·»åŠ ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶

### 3. è¾“å‡ºé˜¶æ®µ
```
ç”Ÿæˆçš„ Go ä»£ç  â†’ å¯ä»¥ç›´æ¥è°ƒç”¨åˆçº¦å‡½æ•°
```

## ğŸ› ï¸ æŠ€æœ¯ç»†èŠ‚

### å‡½æ•°é€‰æ‹©å™¨ç”Ÿæˆ
```go
// Solidity å‡½æ•°
function increment() public returns (uint256)

// ç”Ÿæˆçš„é€‰æ‹©å™¨
increment() â†’ keccak256("increment()") â†’ 0x2baeceb7
```

### å‚æ•°ç¼–ç /è§£ç 
```go
// è¾“å…¥å‚æ•°ç¼–ç 
func encodeInputs(inputs []Input, values []interface{}) []byte

// è¾“å‡ºå‚æ•°è§£ç   
func decodeOutputs(outputs []Output, data []byte) ([]interface{}, error)
```

### ç±»å‹æ˜ å°„
```
Solidity ç±»å‹    â†’    Go ç±»å‹
uint256         â†’    *big.Int
address         â†’    common.Address
string          â†’    string
bool            â†’    bool
bytes32         â†’    [32]byte
```

## ğŸŒ å®é™…é€šä¿¡è¿‡ç¨‹

### è¯»å–æ“ä½œ (Call)
```
Go ä»£ç 
  â†“
contract.GetCount(nil)
  â†“
ç¼–ç å‡½æ•°è°ƒç”¨ (0x2baeceb7)
  â†“
å‘é€ RPC è¯·æ±‚ (eth_call)
  â†“
ä»¥å¤ªåŠèŠ‚ç‚¹æ‰§è¡Œ
  â†“
è¿”å›ç»“æœ (0x0000000000000000000000000000000000000000000000000000000000000005)
  â†“
è§£ç ä¸º Go ç±»å‹ (*big.Int)
  â†“
è¿”å›ç»™ Go ä»£ç 
```

### å†™å…¥æ“ä½œ (Transaction)
```
Go ä»£ç 
  â†“
contract.Increment(auth)
  â†“
ç¼–ç å‡½æ•°è°ƒç”¨ (0x2baeceb7)
  â†“
æ„å»ºäº¤æ˜“
  â†“
ç­¾åäº¤æ˜“
  â†“
å¹¿æ’­åˆ°ç½‘ç»œ
  â†“
ç­‰å¾…ç¡®è®¤
  â†“
è¿”å›äº¤æ˜“å“ˆå¸Œ
```

## ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦ Abigenï¼Ÿ

### æ²¡æœ‰ Abigen çš„å¤æ‚è¿‡ç¨‹ï¼š
```go
// 1. æ‰‹åŠ¨è§£æ ABI
abi, err := abi.JSON(strings.NewReader(contractABI))

// 2. æ‰‹åŠ¨ç¼–ç å‡½æ•°è°ƒç”¨
data, err := abi.Pack("increment")

// 3. æ‰‹åŠ¨æ„å»ºäº¤æ˜“
tx := types.NewTransaction(nonce, contractAddr, value, gasLimit, gasPrice, data)

// 4. æ‰‹åŠ¨ç­¾åå’Œå‘é€
signedTx, err := types.SignTx(tx, signer, privateKey)
err = client.SendTransaction(ctx, signedTx)

// 5. æ‰‹åŠ¨è§£æè¿”å›å€¼
var result []interface{}
err = abi.Unpack(&result, "increment", returnData)
```

### ä½¿ç”¨ Abigen çš„ç®€å•è¿‡ç¨‹ï¼š
```go
// ç›´æ¥è°ƒç”¨ï¼Œabigen å¤„ç†æ‰€æœ‰å¤æ‚ç»†èŠ‚
count, err := contract.GetCount(nil)
tx, err := contract.Increment(auth)
```

## ğŸ¯ æ€»ç»“

**Abigen çš„æ ¸å¿ƒä»·å€¼ï¼š**

1. **è‡ªåŠ¨åŒ–**ï¼šè‡ªåŠ¨å¤„ç†æ‰€æœ‰å¤æ‚çš„åº•å±‚ç»†èŠ‚
2. **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æ—¶æ£€æŸ¥ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯
3. **å¼€å‘æ•ˆç‡**ï¼šä» 50 è¡Œä»£ç å˜æˆ 1 è¡Œä»£ç 
4. **ç»´æŠ¤æ€§**ï¼šåˆçº¦æ›´æ–°åé‡æ–°ç”Ÿæˆå³å¯
5. **å¯è¯»æ€§**ï¼šä»£ç æ›´æ¥è¿‘ä¸šåŠ¡é€»è¾‘

**ç®€å•æ¥è¯´ï¼šAbigen è®© Go å¼€å‘è€…å¯ä»¥åƒè°ƒç”¨æ™®é€šå‡½æ•°ä¸€æ ·è°ƒç”¨æ™ºèƒ½åˆçº¦å‡½æ•°ï¼**
